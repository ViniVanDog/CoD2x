#include <windows.h>
#include <stdio.h>

// Memory addresses of original functions
#define FUNCTIONS_COUNT 364
FARPROC pMSS32_original_functions[FUNCTIONS_COUNT] = { NULL };

// Original DLL
static HMODULE originalDll = NULL;


/*
 * Loads addresses of original functions from mss32_original.dll
 */
bool mss32_load() {
    originalDll = LoadLibrary("mss32_original.dll");
    if (originalDll == NULL) {
        MessageBox(NULL, "Failed to load mss32_original.dll", "Error", MB_OK | MB_ICONERROR);
        return FALSE;
    }

    pMSS32_original_functions[0] = GetProcAddress(originalDll, "_AIL_3D_distance_factor@4");
    pMSS32_original_functions[1] = GetProcAddress(originalDll, "_AIL_3D_doppler_factor@4");
    pMSS32_original_functions[2] = GetProcAddress(originalDll, "_AIL_3D_orientation@28");
    pMSS32_original_functions[3] = GetProcAddress(originalDll, "_AIL_3D_position@16");
    pMSS32_original_functions[4] = GetProcAddress(originalDll, "_AIL_3D_provider_attribute@12");
    pMSS32_original_functions[5] = GetProcAddress(originalDll, "_AIL_3D_rolloff_factor@4");
    pMSS32_original_functions[6] = GetProcAddress(originalDll, "_AIL_3D_room_type@4");
    pMSS32_original_functions[7] = GetProcAddress(originalDll, "_AIL_3D_sample_attribute@12");
    pMSS32_original_functions[8] = GetProcAddress(originalDll, "_AIL_3D_sample_cone@16");
    pMSS32_original_functions[9] = GetProcAddress(originalDll, "_AIL_3D_sample_distances@12");
    pMSS32_original_functions[10] = GetProcAddress(originalDll, "_AIL_3D_sample_effects_level@4");
    pMSS32_original_functions[11] = GetProcAddress(originalDll, "_AIL_3D_sample_exclusion@4");
    pMSS32_original_functions[12] = GetProcAddress(originalDll, "_AIL_3D_sample_length@4");
    pMSS32_original_functions[13] = GetProcAddress(originalDll, "_AIL_3D_sample_loop_count@4");
    pMSS32_original_functions[14] = GetProcAddress(originalDll, "_AIL_3D_sample_obstruction@4");
    pMSS32_original_functions[15] = GetProcAddress(originalDll, "_AIL_3D_sample_occlusion@4");
    pMSS32_original_functions[16] = GetProcAddress(originalDll, "_AIL_3D_sample_offset@4");
    pMSS32_original_functions[17] = GetProcAddress(originalDll, "_AIL_3D_sample_playback_rate@4");
    pMSS32_original_functions[18] = GetProcAddress(originalDll, "_AIL_3D_sample_status@4");
    pMSS32_original_functions[19] = GetProcAddress(originalDll, "_AIL_3D_sample_volume@4");
    pMSS32_original_functions[20] = GetProcAddress(originalDll, "_AIL_3D_speaker_type@4");
    pMSS32_original_functions[21] = GetProcAddress(originalDll, "_AIL_3D_user_data@8");
    pMSS32_original_functions[22] = GetProcAddress(originalDll, "_AIL_3D_velocity@16");
    pMSS32_original_functions[23] = GetProcAddress(originalDll, "_AIL_active_3D_sample_count@4");
    pMSS32_original_functions[24] = GetProcAddress(originalDll, "_AIL_active_sample_count@4");
    pMSS32_original_functions[25] = GetProcAddress(originalDll, "_AIL_active_sequence_count@4");
    pMSS32_original_functions[26] = GetProcAddress(originalDll, "_AIL_allocate_3D_sample_handle@4");
    pMSS32_original_functions[27] = GetProcAddress(originalDll, "_AIL_allocate_file_sample@12");
    pMSS32_original_functions[28] = GetProcAddress(originalDll, "_AIL_allocate_sample_handle@4");
    pMSS32_original_functions[29] = GetProcAddress(originalDll, "_AIL_allocate_sequence_handle@4");
    pMSS32_original_functions[30] = GetProcAddress(originalDll, "_AIL_auto_service_stream@8");
    pMSS32_original_functions[31] = GetProcAddress(originalDll, "_AIL_auto_update_3D_position@8");
    pMSS32_original_functions[32] = GetProcAddress(originalDll, "_AIL_background@0");
    pMSS32_original_functions[33] = GetProcAddress(originalDll, "_AIL_branch_index@8");
    pMSS32_original_functions[34] = GetProcAddress(originalDll, "_AIL_close_3D_listener@4");
    pMSS32_original_functions[35] = GetProcAddress(originalDll, "_AIL_close_3D_object@4");
    pMSS32_original_functions[36] = GetProcAddress(originalDll, "_AIL_close_3D_provider@4");
    pMSS32_original_functions[37] = GetProcAddress(originalDll, "_AIL_close_digital_driver@4");
    pMSS32_original_functions[38] = GetProcAddress(originalDll, "_AIL_close_filter@4");
    pMSS32_original_functions[39] = GetProcAddress(originalDll, "_AIL_close_input@4");
    pMSS32_original_functions[40] = GetProcAddress(originalDll, "_AIL_close_stream@4");
    pMSS32_original_functions[41] = GetProcAddress(originalDll, "_AIL_close_XMIDI_driver@4");
    pMSS32_original_functions[42] = GetProcAddress(originalDll, "_AIL_compress_ADPCM@12");
    pMSS32_original_functions[43] = GetProcAddress(originalDll, "_AIL_compress_ASI@20");
    pMSS32_original_functions[44] = GetProcAddress(originalDll, "_AIL_compress_DLS@20");
    pMSS32_original_functions[45] = GetProcAddress(originalDll, "_AIL_controller_value@12");
    pMSS32_original_functions[46] = GetProcAddress(originalDll, "_AIL_create_wave_synthesizer@16");
    pMSS32_original_functions[47] = GetProcAddress(originalDll, "_AIL_decompress_ADPCM@12");
    pMSS32_original_functions[48] = GetProcAddress(originalDll, "_AIL_decompress_ASI@24");
    pMSS32_original_functions[49] = GetProcAddress(originalDll, "_AIL_delay@4");
    pMSS32_original_functions[50] = GetProcAddress(originalDll, "_AIL_destroy_wave_synthesizer@4");
    pMSS32_original_functions[51] = GetProcAddress(originalDll, "_AIL_digital_configuration@16");
    pMSS32_original_functions[52] = GetProcAddress(originalDll, "_AIL_digital_CPU_percent@4");
    pMSS32_original_functions[53] = GetProcAddress(originalDll, "_AIL_digital_handle_reacquire@4");
    pMSS32_original_functions[54] = GetProcAddress(originalDll, "_AIL_digital_handle_release@4");
    pMSS32_original_functions[55] = GetProcAddress(originalDll, "_AIL_digital_latency@4");
    pMSS32_original_functions[56] = GetProcAddress(originalDll, "_AIL_digital_master_reverb_levels@12");
    pMSS32_original_functions[57] = GetProcAddress(originalDll, "_AIL_digital_master_reverb@16");
    pMSS32_original_functions[58] = GetProcAddress(originalDll, "_AIL_digital_master_volume_level@4");
    pMSS32_original_functions[59] = GetProcAddress(originalDll, "_AIL_DLS_close@8");
    pMSS32_original_functions[60] = GetProcAddress(originalDll, "_AIL_DLS_compact@4");
    pMSS32_original_functions[61] = GetProcAddress(originalDll, "_AIL_DLS_get_info@12");
    pMSS32_original_functions[62] = GetProcAddress(originalDll, "_AIL_DLS_get_reverb_levels@12");
    pMSS32_original_functions[63] = GetProcAddress(originalDll, "_AIL_DLS_load_file@12");
    pMSS32_original_functions[64] = GetProcAddress(originalDll, "_AIL_DLS_load_memory@12");
    pMSS32_original_functions[65] = GetProcAddress(originalDll, "_AIL_DLS_open@28");
    pMSS32_original_functions[66] = GetProcAddress(originalDll, "_AIL_DLS_set_reverb_levels@12");
    pMSS32_original_functions[67] = GetProcAddress(originalDll, "_AIL_DLS_unload@8");
    pMSS32_original_functions[68] = GetProcAddress(originalDll, "_AIL_end_3D_sample@4");
    pMSS32_original_functions[69] = GetProcAddress(originalDll, "_AIL_end_sample@4");
    pMSS32_original_functions[70] = GetProcAddress(originalDll, "_AIL_end_sequence@4");
    pMSS32_original_functions[71] = GetProcAddress(originalDll, "_AIL_enumerate_3D_provider_attributes@12");
    pMSS32_original_functions[72] = GetProcAddress(originalDll, "_AIL_enumerate_3D_providers@12");
    pMSS32_original_functions[73] = GetProcAddress(originalDll, "_AIL_enumerate_3D_sample_attributes@12");
    pMSS32_original_functions[74] = GetProcAddress(originalDll, "_AIL_enumerate_filter_attributes@12");
    pMSS32_original_functions[75] = GetProcAddress(originalDll, "_AIL_enumerate_filter_sample_attributes@12");
    pMSS32_original_functions[76] = GetProcAddress(originalDll, "_AIL_enumerate_filters@12");
    pMSS32_original_functions[77] = GetProcAddress(originalDll, "_AIL_extract_DLS@28");
    pMSS32_original_functions[78] = GetProcAddress(originalDll, "_AIL_file_error@0");
    pMSS32_original_functions[79] = GetProcAddress(originalDll, "_AIL_file_read@8");
    pMSS32_original_functions[80] = GetProcAddress(originalDll, "_AIL_file_size@4");
    pMSS32_original_functions[81] = GetProcAddress(originalDll, "_AIL_file_type@8");
    pMSS32_original_functions[82] = GetProcAddress(originalDll, "_AIL_file_write@12");
    pMSS32_original_functions[83] = GetProcAddress(originalDll, "_AIL_filter_attribute@12");
    pMSS32_original_functions[84] = GetProcAddress(originalDll, "_AIL_filter_DLS_attribute@12");
    pMSS32_original_functions[85] = GetProcAddress(originalDll, "_AIL_filter_DLS_with_XMI@24");
    pMSS32_original_functions[86] = GetProcAddress(originalDll, "_AIL_filter_sample_attribute@12");
    pMSS32_original_functions[87] = GetProcAddress(originalDll, "_AIL_filter_stream_attribute@12");
    pMSS32_original_functions[88] = GetProcAddress(originalDll, "_AIL_find_DLS@24");
    pMSS32_original_functions[89] = GetProcAddress(originalDll, "_AIL_get_DirectSound_info@12");
    pMSS32_original_functions[90] = GetProcAddress(originalDll, "_AIL_get_input_info@4");
    pMSS32_original_functions[91] = GetProcAddress(originalDll, "_AIL_get_preference@4");
    pMSS32_original_functions[92] = GetProcAddress(originalDll, "_AIL_get_timer_highest_delay@0");
    pMSS32_original_functions[93] = GetProcAddress(originalDll, "_AIL_HWND@0");
    pMSS32_original_functions[94] = GetProcAddress(originalDll, "_AIL_channel_notes@8");
    pMSS32_original_functions[95] = GetProcAddress(originalDll, "_AIL_init_sample@4");
    pMSS32_original_functions[96] = GetProcAddress(originalDll, "_AIL_init_sequence@12");
    pMSS32_original_functions[97] = GetProcAddress(originalDll, "_AIL_last_error@0");
    pMSS32_original_functions[98] = GetProcAddress(originalDll, "_AIL_list_DLS@20");
    pMSS32_original_functions[99] = GetProcAddress(originalDll, "_AIL_list_MIDI@20");
    pMSS32_original_functions[100] = GetProcAddress(originalDll, "_AIL_load_sample_buffer@16");
    pMSS32_original_functions[101] = GetProcAddress(originalDll, "_AIL_lock_channel@4");
    pMSS32_original_functions[102] = GetProcAddress(originalDll, "_AIL_lock_mutex@0");
    pMSS32_original_functions[103] = GetProcAddress(originalDll, "_AIL_lock@0");
    pMSS32_original_functions[104] = GetProcAddress(originalDll, "_AIL_map_sequence_channel@12");
    pMSS32_original_functions[105] = GetProcAddress(originalDll, "_AIL_mem_alloc_lock@4");
    pMSS32_original_functions[106] = GetProcAddress(originalDll, "_AIL_mem_free_lock@4");
    pMSS32_original_functions[107] = GetProcAddress(originalDll, "_AIL_mem_use_free@4");
    pMSS32_original_functions[108] = GetProcAddress(originalDll, "_AIL_mem_use_malloc@4");
    pMSS32_original_functions[109] = GetProcAddress(originalDll, "_AIL_merge_DLS_with_XMI@16");
    pMSS32_original_functions[110] = GetProcAddress(originalDll, "_AIL_MIDI_handle_reacquire@4");
    pMSS32_original_functions[111] = GetProcAddress(originalDll, "_AIL_MIDI_handle_release@4");
    pMSS32_original_functions[112] = GetProcAddress(originalDll, "_AIL_MIDI_to_XMI@20");
    pMSS32_original_functions[113] = GetProcAddress(originalDll, "_AIL_midiOutClose@4");
    pMSS32_original_functions[114] = GetProcAddress(originalDll, "_AIL_midiOutOpen@12");
    pMSS32_original_functions[115] = GetProcAddress(originalDll, "_AIL_minimum_sample_buffer_size@12");
    pMSS32_original_functions[116] = GetProcAddress(originalDll, "_AIL_MMX_available@0");
    pMSS32_original_functions[117] = GetProcAddress(originalDll, "_AIL_ms_count@0");
    pMSS32_original_functions[118] = GetProcAddress(originalDll, "_AIL_open_3D_listener@4");
    pMSS32_original_functions[119] = GetProcAddress(originalDll, "_AIL_open_3D_object@4");
    pMSS32_original_functions[120] = GetProcAddress(originalDll, "_AIL_open_3D_provider@4");
    pMSS32_original_functions[121] = GetProcAddress(originalDll, "_AIL_open_digital_driver@16");
    pMSS32_original_functions[122] = GetProcAddress(originalDll, "_AIL_open_filter@8");
    pMSS32_original_functions[123] = GetProcAddress(originalDll, "_AIL_open_input@4");
    pMSS32_original_functions[124] = GetProcAddress(originalDll, "_AIL_open_stream@12");
    pMSS32_original_functions[125] = GetProcAddress(originalDll, "_AIL_open_XMIDI_driver@4");
    pMSS32_original_functions[126] = GetProcAddress(originalDll, "_AIL_pause_stream@8");
    pMSS32_original_functions[127] = GetProcAddress(originalDll, "_AIL_primary_digital_driver@4");
    pMSS32_original_functions[128] = GetProcAddress(originalDll, "_AIL_process_digital_audio@24");
    pMSS32_original_functions[129] = GetProcAddress(originalDll, "_AIL_quick_copy@4");
    pMSS32_original_functions[130] = GetProcAddress(originalDll, "_AIL_quick_halt@4");
    pMSS32_original_functions[131] = GetProcAddress(originalDll, "_AIL_quick_handles@12");
    pMSS32_original_functions[132] = GetProcAddress(originalDll, "_AIL_quick_load_and_play@12");
    pMSS32_original_functions[133] = GetProcAddress(originalDll, "_AIL_quick_load_mem@8");
    pMSS32_original_functions[134] = GetProcAddress(originalDll, "_AIL_quick_load@4");
    pMSS32_original_functions[135] = GetProcAddress(originalDll, "_AIL_quick_ms_length@4");
    pMSS32_original_functions[136] = GetProcAddress(originalDll, "_AIL_quick_ms_position@4");
    pMSS32_original_functions[137] = GetProcAddress(originalDll, "_AIL_quick_play@8");
    pMSS32_original_functions[138] = GetProcAddress(originalDll, "_AIL_quick_set_low_pass_cut_off@8");
    pMSS32_original_functions[139] = GetProcAddress(originalDll, "_AIL_quick_set_ms_position@8");
    pMSS32_original_functions[140] = GetProcAddress(originalDll, "_AIL_quick_set_reverb_levels@12");
    pMSS32_original_functions[141] = GetProcAddress(originalDll, "_AIL_quick_set_speed@8");
    pMSS32_original_functions[142] = GetProcAddress(originalDll, "_AIL_quick_set_volume@12");
    pMSS32_original_functions[143] = GetProcAddress(originalDll, "_AIL_quick_shutdown@0");
    pMSS32_original_functions[144] = GetProcAddress(originalDll, "_AIL_quick_startup@20");
    pMSS32_original_functions[145] = GetProcAddress(originalDll, "_AIL_quick_status@4");
    pMSS32_original_functions[146] = GetProcAddress(originalDll, "_AIL_quick_type@4");
    pMSS32_original_functions[147] = GetProcAddress(originalDll, "_AIL_quick_unload@4");
    pMSS32_original_functions[148] = GetProcAddress(originalDll, "_AIL_redbook_close@4");
    pMSS32_original_functions[149] = GetProcAddress(originalDll, "_AIL_redbook_eject@4");
    pMSS32_original_functions[150] = GetProcAddress(originalDll, "_AIL_redbook_id@4");
    pMSS32_original_functions[151] = GetProcAddress(originalDll, "_AIL_redbook_open_drive@4");
    pMSS32_original_functions[152] = GetProcAddress(originalDll, "_AIL_redbook_open@4");
    pMSS32_original_functions[153] = GetProcAddress(originalDll, "_AIL_redbook_pause@4");
    pMSS32_original_functions[154] = GetProcAddress(originalDll, "_AIL_redbook_play@12");
    pMSS32_original_functions[155] = GetProcAddress(originalDll, "_AIL_redbook_position@4");
    pMSS32_original_functions[156] = GetProcAddress(originalDll, "_AIL_redbook_resume@4");
    pMSS32_original_functions[157] = GetProcAddress(originalDll, "_AIL_redbook_retract@4");
    pMSS32_original_functions[158] = GetProcAddress(originalDll, "_AIL_redbook_set_volume_level@8");
    pMSS32_original_functions[159] = GetProcAddress(originalDll, "_AIL_redbook_status@4");
    pMSS32_original_functions[160] = GetProcAddress(originalDll, "_AIL_redbook_stop@4");
    pMSS32_original_functions[161] = GetProcAddress(originalDll, "_AIL_redbook_track_info@16");
    pMSS32_original_functions[162] = GetProcAddress(originalDll, "_AIL_redbook_track@4");
    pMSS32_original_functions[163] = GetProcAddress(originalDll, "_AIL_redbook_tracks@4");
    pMSS32_original_functions[164] = GetProcAddress(originalDll, "_AIL_redbook_volume_level@4");
    pMSS32_original_functions[165] = GetProcAddress(originalDll, "_AIL_register_3D_EOS_callback@8");
    pMSS32_original_functions[166] = GetProcAddress(originalDll, "_AIL_register_beat_callback@8");
    pMSS32_original_functions[167] = GetProcAddress(originalDll, "_AIL_register_EOB_callback@8");
    pMSS32_original_functions[168] = GetProcAddress(originalDll, "_AIL_register_EOF_callback@8");
    pMSS32_original_functions[169] = GetProcAddress(originalDll, "_AIL_register_EOS_callback@8");
    pMSS32_original_functions[170] = GetProcAddress(originalDll, "_AIL_register_event_callback@8");
    pMSS32_original_functions[171] = GetProcAddress(originalDll, "_AIL_register_ICA_array@8");
    pMSS32_original_functions[172] = GetProcAddress(originalDll, "_AIL_register_prefix_callback@8");
    pMSS32_original_functions[173] = GetProcAddress(originalDll, "_AIL_register_sequence_callback@8");
    pMSS32_original_functions[174] = GetProcAddress(originalDll, "_AIL_register_SOB_callback@8");
    pMSS32_original_functions[175] = GetProcAddress(originalDll, "_AIL_register_stream_callback@8");
    pMSS32_original_functions[176] = GetProcAddress(originalDll, "_AIL_register_timbre_callback@8");
    pMSS32_original_functions[177] = GetProcAddress(originalDll, "_AIL_register_timer@4");
    pMSS32_original_functions[178] = GetProcAddress(originalDll, "_AIL_register_trigger_callback@8");
    pMSS32_original_functions[179] = GetProcAddress(originalDll, "_AIL_release_3D_sample_handle@4");
    pMSS32_original_functions[180] = GetProcAddress(originalDll, "_AIL_release_all_timers@0");
    pMSS32_original_functions[181] = GetProcAddress(originalDll, "_AIL_release_channel@8");
    pMSS32_original_functions[182] = GetProcAddress(originalDll, "_AIL_release_sample_handle@4");
    pMSS32_original_functions[183] = GetProcAddress(originalDll, "_AIL_release_sequence_handle@4");
    pMSS32_original_functions[184] = GetProcAddress(originalDll, "_AIL_release_timer_handle@4");
    pMSS32_original_functions[185] = GetProcAddress(originalDll, "_AIL_request_EOB_ASI_reset@8");
    pMSS32_original_functions[186] = GetProcAddress(originalDll, "_AIL_resume_3D_sample@4");
    pMSS32_original_functions[187] = GetProcAddress(originalDll, "_AIL_resume_sample@4");
    pMSS32_original_functions[188] = GetProcAddress(originalDll, "_AIL_resume_sequence@4");
    pMSS32_original_functions[189] = GetProcAddress(originalDll, "_AIL_sample_buffer_info@20");
    pMSS32_original_functions[190] = GetProcAddress(originalDll, "_AIL_sample_buffer_ready@4");
    pMSS32_original_functions[191] = GetProcAddress(originalDll, "_AIL_sample_granularity@4");
    pMSS32_original_functions[192] = GetProcAddress(originalDll, "_AIL_sample_loop_count@4");
    pMSS32_original_functions[193] = GetProcAddress(originalDll, "_AIL_sample_low_pass_cut_off@4");
    pMSS32_original_functions[194] = GetProcAddress(originalDll, "_AIL_sample_ms_position@12");
    pMSS32_original_functions[195] = GetProcAddress(originalDll, "_AIL_sample_playback_rate@4");
    pMSS32_original_functions[196] = GetProcAddress(originalDll, "_AIL_sample_position@4");
    pMSS32_original_functions[197] = GetProcAddress(originalDll, "_AIL_sample_reverb_levels@12");
    pMSS32_original_functions[198] = GetProcAddress(originalDll, "_AIL_sample_status@4");
    pMSS32_original_functions[199] = GetProcAddress(originalDll, "_AIL_sample_user_data@8");
    pMSS32_original_functions[200] = GetProcAddress(originalDll, "_AIL_sample_volume_levels@12");
    pMSS32_original_functions[201] = GetProcAddress(originalDll, "_AIL_sample_volume_pan@12");
    pMSS32_original_functions[202] = GetProcAddress(originalDll, "_AIL_send_channel_voice_message@20");
    pMSS32_original_functions[203] = GetProcAddress(originalDll, "_AIL_send_sysex_message@8");
    pMSS32_original_functions[204] = GetProcAddress(originalDll, "_AIL_sequence_loop_count@4");
    pMSS32_original_functions[205] = GetProcAddress(originalDll, "_AIL_sequence_ms_position@12");
    pMSS32_original_functions[206] = GetProcAddress(originalDll, "_AIL_sequence_position@12");
    pMSS32_original_functions[207] = GetProcAddress(originalDll, "_AIL_sequence_status@4");
    pMSS32_original_functions[208] = GetProcAddress(originalDll, "_AIL_sequence_tempo@4");
    pMSS32_original_functions[209] = GetProcAddress(originalDll, "_AIL_sequence_user_data@8");
    pMSS32_original_functions[210] = GetProcAddress(originalDll, "_AIL_sequence_volume@4");
    pMSS32_original_functions[211] = GetProcAddress(originalDll, "_AIL_serve@0");
    pMSS32_original_functions[212] = GetProcAddress(originalDll, "_AIL_service_stream@8");
    pMSS32_original_functions[213] = GetProcAddress(originalDll, "_AIL_set_3D_distance_factor@8");
    pMSS32_original_functions[214] = GetProcAddress(originalDll, "_AIL_set_3D_doppler_factor@8");
    pMSS32_original_functions[215] = GetProcAddress(originalDll, "_AIL_set_3D_orientation@28");
    pMSS32_original_functions[216] = GetProcAddress(originalDll, "_AIL_set_3D_position@16");
    pMSS32_original_functions[217] = GetProcAddress(originalDll, "_AIL_set_3D_provider_preference@12");
    pMSS32_original_functions[218] = GetProcAddress(originalDll, "_AIL_set_3D_rolloff_factor@8");
    pMSS32_original_functions[219] = GetProcAddress(originalDll, "_AIL_set_3D_room_type@8");
    pMSS32_original_functions[220] = GetProcAddress(originalDll, "_AIL_set_3D_sample_cone@16");
    pMSS32_original_functions[221] = GetProcAddress(originalDll, "_AIL_set_3D_sample_distances@12");
    pMSS32_original_functions[222] = GetProcAddress(originalDll, "_AIL_set_3D_sample_effects_level@8");
    pMSS32_original_functions[223] = GetProcAddress(originalDll, "_AIL_set_3D_sample_exclusion@8");
    pMSS32_original_functions[224] = GetProcAddress(originalDll, "_AIL_set_3D_sample_file@8");
    pMSS32_original_functions[225] = GetProcAddress(originalDll, "_AIL_set_3D_sample_info@8");
    pMSS32_original_functions[226] = GetProcAddress(originalDll, "_AIL_set_3D_sample_loop_block@12");
    pMSS32_original_functions[227] = GetProcAddress(originalDll, "_AIL_set_3D_sample_loop_count@8");
    pMSS32_original_functions[228] = GetProcAddress(originalDll, "_AIL_set_3D_sample_obstruction@8");
    pMSS32_original_functions[229] = GetProcAddress(originalDll, "_AIL_set_3D_sample_occlusion@8");
    pMSS32_original_functions[230] = GetProcAddress(originalDll, "_AIL_set_3D_sample_offset@8");
    pMSS32_original_functions[231] = GetProcAddress(originalDll, "_AIL_set_3D_sample_playback_rate@8");
    pMSS32_original_functions[232] = GetProcAddress(originalDll, "_AIL_set_3D_sample_preference@12");
    pMSS32_original_functions[233] = GetProcAddress(originalDll, "_AIL_set_3D_sample_volume@8");
    pMSS32_original_functions[234] = GetProcAddress(originalDll, "_AIL_set_3D_speaker_type@8");
    pMSS32_original_functions[235] = GetProcAddress(originalDll, "_AIL_set_3D_user_data@12");
    pMSS32_original_functions[236] = GetProcAddress(originalDll, "_AIL_set_3D_velocity_vector@16");
    pMSS32_original_functions[237] = GetProcAddress(originalDll, "_AIL_set_3D_velocity@20");
    pMSS32_original_functions[238] = GetProcAddress(originalDll, "_AIL_set_digital_driver_processor@12");
    pMSS32_original_functions[239] = GetProcAddress(originalDll, "_AIL_set_digital_master_reverb_levels@12");
    pMSS32_original_functions[240] = GetProcAddress(originalDll, "_AIL_set_digital_master_reverb@16");
    pMSS32_original_functions[241] = GetProcAddress(originalDll, "_AIL_set_digital_master_room_type@8");
    pMSS32_original_functions[242] = GetProcAddress(originalDll, "_AIL_set_digital_master_volume_level@8");
    pMSS32_original_functions[243] = GetProcAddress(originalDll, "_AIL_set_DirectSound_HWND@8");
    pMSS32_original_functions[244] = GetProcAddress(originalDll, "_AIL_set_DLS_processor@12");
    pMSS32_original_functions[245] = GetProcAddress(originalDll, "_AIL_set_error@4");
    pMSS32_original_functions[246] = GetProcAddress(originalDll, "_AIL_set_file_async_callbacks@20");
    pMSS32_original_functions[247] = GetProcAddress(originalDll, "_AIL_set_file_callbacks@16");
    pMSS32_original_functions[248] = GetProcAddress(originalDll, "_AIL_set_filter_DLS_preference@12");
    pMSS32_original_functions[249] = GetProcAddress(originalDll, "_AIL_set_filter_preference@12");
    pMSS32_original_functions[250] = GetProcAddress(originalDll, "_AIL_set_filter_sample_preference@12");
    pMSS32_original_functions[251] = GetProcAddress(originalDll, "_AIL_set_filter_stream_preference@12");
    pMSS32_original_functions[252] = GetProcAddress(originalDll, "_AIL_set_input_state@8");
    pMSS32_original_functions[253] = GetProcAddress(originalDll, "_AIL_set_named_sample_file@20");
    pMSS32_original_functions[254] = GetProcAddress(originalDll, "_AIL_set_preference@8");
    pMSS32_original_functions[255] = GetProcAddress(originalDll, "_AIL_set_redist_directory@4");
    pMSS32_original_functions[256] = GetProcAddress(originalDll, "_AIL_set_sample_address@12");
    pMSS32_original_functions[257] = GetProcAddress(originalDll, "_AIL_set_sample_adpcm_block_size@8");
    pMSS32_original_functions[258] = GetProcAddress(originalDll, "_AIL_set_sample_file@12");
    pMSS32_original_functions[259] = GetProcAddress(originalDll, "_AIL_set_sample_loop_block@12");
    pMSS32_original_functions[260] = GetProcAddress(originalDll, "_AIL_set_sample_loop_count@8");
    pMSS32_original_functions[261] = GetProcAddress(originalDll, "_AIL_set_sample_low_pass_cut_off@8");
    pMSS32_original_functions[262] = GetProcAddress(originalDll, "_AIL_set_sample_ms_position@8");
    pMSS32_original_functions[263] = GetProcAddress(originalDll, "_AIL_set_sample_playback_rate@8");
    pMSS32_original_functions[264] = GetProcAddress(originalDll, "_AIL_set_sample_position@8");
    pMSS32_original_functions[265] = GetProcAddress(originalDll, "_AIL_set_sample_processor@12");
    pMSS32_original_functions[266] = GetProcAddress(originalDll, "_AIL_set_sample_reverb_levels@12");
    pMSS32_original_functions[267] = GetProcAddress(originalDll, "_AIL_set_sample_type@12");
    pMSS32_original_functions[268] = GetProcAddress(originalDll, "_AIL_set_sample_user_data@12");
    pMSS32_original_functions[269] = GetProcAddress(originalDll, "_AIL_set_sample_volume_levels@12");
    pMSS32_original_functions[270] = GetProcAddress(originalDll, "_AIL_set_sample_volume_pan@12");
    pMSS32_original_functions[271] = GetProcAddress(originalDll, "_AIL_set_sequence_loop_count@8");
    pMSS32_original_functions[272] = GetProcAddress(originalDll, "_AIL_set_sequence_ms_position@8");
    pMSS32_original_functions[273] = GetProcAddress(originalDll, "_AIL_set_sequence_tempo@12");
    pMSS32_original_functions[274] = GetProcAddress(originalDll, "_AIL_set_sequence_user_data@12");
    pMSS32_original_functions[275] = GetProcAddress(originalDll, "_AIL_set_sequence_volume@12");
    pMSS32_original_functions[276] = GetProcAddress(originalDll, "_AIL_set_stream_loop_block@12");
    pMSS32_original_functions[277] = GetProcAddress(originalDll, "_AIL_set_stream_loop_count@8");
    pMSS32_original_functions[278] = GetProcAddress(originalDll, "_AIL_set_stream_low_pass_cut_off@8");
    pMSS32_original_functions[279] = GetProcAddress(originalDll, "_AIL_set_stream_ms_position@8");
    pMSS32_original_functions[280] = GetProcAddress(originalDll, "_AIL_set_stream_playback_rate@8");
    pMSS32_original_functions[281] = GetProcAddress(originalDll, "_AIL_set_stream_position@8");
    pMSS32_original_functions[282] = GetProcAddress(originalDll, "_AIL_set_stream_processor@12");
    pMSS32_original_functions[283] = GetProcAddress(originalDll, "_AIL_set_stream_reverb_levels@12");
    pMSS32_original_functions[284] = GetProcAddress(originalDll, "_AIL_set_stream_user_data@12");
    pMSS32_original_functions[285] = GetProcAddress(originalDll, "_AIL_set_stream_volume_levels@12");
    pMSS32_original_functions[286] = GetProcAddress(originalDll, "_AIL_set_stream_volume_pan@12");
    pMSS32_original_functions[287] = GetProcAddress(originalDll, "_AIL_set_timer_divisor@8");
    pMSS32_original_functions[288] = GetProcAddress(originalDll, "_AIL_set_timer_frequency@8");
    pMSS32_original_functions[289] = GetProcAddress(originalDll, "_AIL_set_timer_period@8");
    pMSS32_original_functions[290] = GetProcAddress(originalDll, "_AIL_set_timer_user@8");
    pMSS32_original_functions[291] = GetProcAddress(originalDll, "_AIL_set_XMIDI_master_volume@8");
    pMSS32_original_functions[292] = GetProcAddress(originalDll, "_AIL_shutdown@0");
    pMSS32_original_functions[293] = GetProcAddress(originalDll, "_AIL_size_processed_digital_audio@16");
    pMSS32_original_functions[294] = GetProcAddress(originalDll, "_AIL_start_3D_sample@4");
    pMSS32_original_functions[295] = GetProcAddress(originalDll, "_AIL_start_all_timers@0");
    pMSS32_original_functions[296] = GetProcAddress(originalDll, "_AIL_start_sample@4");
    pMSS32_original_functions[297] = GetProcAddress(originalDll, "_AIL_start_sequence@4");
    pMSS32_original_functions[298] = GetProcAddress(originalDll, "_AIL_start_stream@4");
    pMSS32_original_functions[299] = GetProcAddress(originalDll, "_AIL_start_timer@4");
    pMSS32_original_functions[300] = GetProcAddress(originalDll, "_AIL_startup@0");
    pMSS32_original_functions[301] = GetProcAddress(originalDll, "_AIL_stop_3D_sample@4");
    pMSS32_original_functions[302] = GetProcAddress(originalDll, "_AIL_stop_all_timers@0");
    pMSS32_original_functions[303] = GetProcAddress(originalDll, "_AIL_stop_sample@4");
    pMSS32_original_functions[304] = GetProcAddress(originalDll, "_AIL_stop_sequence@4");
    pMSS32_original_functions[305] = GetProcAddress(originalDll, "_AIL_stop_timer@4");
    pMSS32_original_functions[306] = GetProcAddress(originalDll, "_AIL_stream_info@20");
    pMSS32_original_functions[307] = GetProcAddress(originalDll, "_AIL_stream_loop_count@4");
    pMSS32_original_functions[308] = GetProcAddress(originalDll, "_AIL_stream_low_pass_cut_off@4");
    pMSS32_original_functions[309] = GetProcAddress(originalDll, "_AIL_stream_ms_position@12");
    pMSS32_original_functions[310] = GetProcAddress(originalDll, "_AIL_stream_playback_rate@4");
    pMSS32_original_functions[311] = GetProcAddress(originalDll, "_AIL_stream_position@4");
    pMSS32_original_functions[312] = GetProcAddress(originalDll, "_AIL_stream_reverb_levels@12");
    pMSS32_original_functions[313] = GetProcAddress(originalDll, "_AIL_stream_status@4");
    pMSS32_original_functions[314] = GetProcAddress(originalDll, "_AIL_stream_user_data@8");
    pMSS32_original_functions[315] = GetProcAddress(originalDll, "_AIL_stream_volume_levels@12");
    pMSS32_original_functions[316] = GetProcAddress(originalDll, "_AIL_stream_volume_pan@12");
    pMSS32_original_functions[317] = GetProcAddress(originalDll, "_AIL_true_sequence_channel@8");
    pMSS32_original_functions[318] = GetProcAddress(originalDll, "_AIL_unlock_mutex@0");
    pMSS32_original_functions[319] = GetProcAddress(originalDll, "_AIL_unlock@0");
    pMSS32_original_functions[320] = GetProcAddress(originalDll, "_AIL_update_3D_position@8");
    pMSS32_original_functions[321] = GetProcAddress(originalDll, "_AIL_us_count@0");
    pMSS32_original_functions[322] = GetProcAddress(originalDll, "_AIL_WAV_file_write@20");
    pMSS32_original_functions[323] = GetProcAddress(originalDll, "_AIL_WAV_info@8");
    pMSS32_original_functions[324] = GetProcAddress(originalDll, "_AIL_waveOutClose@4");
    pMSS32_original_functions[325] = GetProcAddress(originalDll, "_AIL_waveOutOpen@16");
    pMSS32_original_functions[326] = GetProcAddress(originalDll, "_AIL_XMIDI_master_volume@4");
    pMSS32_original_functions[327] = GetProcAddress(originalDll, "_DllMain@12");
    pMSS32_original_functions[328] = GetProcAddress(originalDll, "_DLSMSSGetCPU@4");
    pMSS32_original_functions[329] = GetProcAddress(originalDll, "_MIX_RIB_MAIN@8");
    pMSS32_original_functions[330] = GetProcAddress(originalDll, "_RIB_enumerate_providers@12");
    pMSS32_original_functions[331] = GetProcAddress(originalDll, "_RIB_find_file_dec_provider@20");
    pMSS32_original_functions[332] = GetProcAddress(originalDll, "_RIB_find_files_provider@20");
    pMSS32_original_functions[333] = GetProcAddress(originalDll, "_RIB_find_provider@12");
    pMSS32_original_functions[334] = GetProcAddress(originalDll, "_RIB_load_application_providers@4");
    pMSS32_original_functions[335] = GetProcAddress(originalDll, "_RIB_load_static_provider_library@8");
    pMSS32_original_functions[336] = GetProcAddress(originalDll, "_RIB_provider_system_data@8");
    pMSS32_original_functions[337] = GetProcAddress(originalDll, "_RIB_provider_user_data@8");
    pMSS32_original_functions[338] = GetProcAddress(originalDll, "_RIB_set_provider_system_data@12");
    pMSS32_original_functions[339] = GetProcAddress(originalDll, "_RIB_set_provider_user_data@12");
    pMSS32_original_functions[340] = GetProcAddress(originalDll, "AIL_debug_printf");
    pMSS32_original_functions[341] = GetProcAddress(originalDll, "AIL_sprintf");
    pMSS32_original_functions[342] = GetProcAddress(originalDll, "DLSClose");
    pMSS32_original_functions[343] = GetProcAddress(originalDll, "DLSCompactMemory");
    pMSS32_original_functions[344] = GetProcAddress(originalDll, "DLSGetInfo");
    pMSS32_original_functions[345] = GetProcAddress(originalDll, "DLSLoadFile");
    pMSS32_original_functions[346] = GetProcAddress(originalDll, "DLSLoadMemFile");
    pMSS32_original_functions[347] = GetProcAddress(originalDll, "DLSMSSOpen");
    pMSS32_original_functions[348] = GetProcAddress(originalDll, "DLSSetAttribute");
    pMSS32_original_functions[349] = GetProcAddress(originalDll, "DLSUnloadAll");
    pMSS32_original_functions[350] = GetProcAddress(originalDll, "DLSUnloadFile");
    pMSS32_original_functions[351] = GetProcAddress(originalDll, "RIB_alloc_provider_handle");
    pMSS32_original_functions[352] = GetProcAddress(originalDll, "RIB_enumerate_interface");
    pMSS32_original_functions[353] = GetProcAddress(originalDll, "RIB_error");
    pMSS32_original_functions[354] = GetProcAddress(originalDll, "RIB_find_file_provider");
    pMSS32_original_functions[355] = GetProcAddress(originalDll, "RIB_free_provider_handle");
    pMSS32_original_functions[356] = GetProcAddress(originalDll, "RIB_free_provider_library");
    pMSS32_original_functions[357] = GetProcAddress(originalDll, "RIB_load_provider_library");
    pMSS32_original_functions[358] = GetProcAddress(originalDll, "RIB_register_interface");
    pMSS32_original_functions[359] = GetProcAddress(originalDll, "RIB_request_interface");
    pMSS32_original_functions[360] = GetProcAddress(originalDll, "RIB_request_interface_entry");
    pMSS32_original_functions[361] = GetProcAddress(originalDll, "RIB_type_string");
    pMSS32_original_functions[362] = GetProcAddress(originalDll, "RIB_unregister_interface");
    pMSS32_original_functions[363] = GetProcAddress(originalDll, "stream_background");

    // Check if all functions are loaded
    for (unsigned int i = 0; i < FUNCTIONS_COUNT; i++) {
        if (pMSS32_original_functions[i] == NULL) {
            char error[100];
            sprintf(error, "Error loading function from mss_original.dll at index %d", i);
            MessageBox(NULL, error, "Error", MB_OK | MB_ICONERROR);
            return FALSE;
        }
    }

    return TRUE;
}
